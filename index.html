<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="–û–ø—É—Å: –ë–æ—Ç-–°–ø—ñ–≤–∞–≤—Ç–æ—Ä - –≤–∞—à –æ—Å–æ–±–∏—Å—Ç–∏–π –ø–æ–º—ñ—á–Ω–∏–∫ –¥–ª—è –Ω–∞–ø–∏—Å–∞–Ω–Ω—è –∫–Ω–∏–≥ –Ω–∞ –±–∞–∑—ñ Gemini 2.5 Flash.">
    <meta name="theme-color" content="#2b2b2b"> 
    <title>–û–ø—É—Å: –ë–æ—Ç-–°–ø—ñ–≤–∞–≤—Ç–æ—Ä</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="spinner-overlay" class="hidden">
        <div class="spinner"></div>
    </div>

    <div id="toast-container"></div>

    <div id="create-edit-modal" class="modal hidden">
        <div class="modal-content">
            <h3 id="create-edit-modal-title"></h3>
            <input type="text" id="create-edit-input" placeholder="–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É">
            <div class="modal-buttons">
                <button id="create-edit-confirm-btn" class="btn-primary">OK</button>
                <button id="create-edit-cancel-btn" class="btn-secondary">–í—ñ–¥–º—ñ–Ω–∞</button>
            </div>
        </div>
    </div>

    <div id="confirm-modal" class="modal hidden">
        <div class="modal-content">
            <h3 id="confirm-modal-title"></h3>
            <p id="confirm-modal-text"></p>
            <div class="modal-buttons">
                <button id="confirm-modal-confirm-btn" class="btn-danger">OK</button>
                <button id="confirm-modal-cancel-btn" class="btn-secondary">–í—ñ–¥–º—ñ–Ω–∞</button>
            </div>
        </div>
    </div>

    <div id="auth-container" class="container hidden">
        <h2>–û–ø—É—Å: –ë–æ—Ç-–°–ø—ñ–≤–∞–≤—Ç–æ—Ä</h2>
        <p>–í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∏–π –ø–æ–º—ñ—á–Ω–∏–∫ –¥–ª—è –Ω–∞–ø–∏—Å–∞–Ω–Ω—è –∫–Ω–∏–≥ –Ω–∞ –±–∞–∑—ñ Gemini.</p>
        <button id="sign-in-btn" class="btn-primary">–£–≤—ñ–π—Ç–∏ —á–µ—Ä–µ–∑ Google</button>
    </div>

    <div id="projects-container" class="container hidden">
        <div class="projects-header">
            <h2>–ú–æ—ó –ø—Ä–æ—î–∫—Ç–∏</h2>
            <div>
                <span id="user-display"></span>
                <button id="sign-out-btn" class="btn-secondary hidden">–í–∏–π—Ç–∏</button>
            </div>
        </div>
        <button id="create-project-btn" class="btn-primary">–°—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–æ—î–∫—Ç</button>
        <div id="projects-list">
            </div>
    </div>
    
    <div id="workspace-container" class="container hidden">
        <header id="workspace-header">
            <div class="header-left">
                <button id="back-to-projects-btn" class="btn-secondary">&larr; –î–æ –ø—Ä–æ—î–∫—Ç—ñ–≤</button>
                <div>
                    <h2 id="workspace-title">–ù–∞–∑–≤–∞ –ü—Ä–æ—î–∫—Ç—É</h2>
                    <input type="text" id="workspace-title-input" class="hidden">
                </div>
                <div id="save-status-indicator" title="–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –¥–ª—è –ø—Ä–∏–º—É—Å–æ–≤–æ–≥–æ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è (Ctrl+S)">
                    <span id="save-status-spinner" class="hidden"></span>
                    <span id="save-status-text">–ó–±–µ—Ä–µ–∂–µ–Ω–æ</span>
                </div>
            </div>
            <div class="header-right">
                <input type="text" id="global-search-input" placeholder="–ü–æ—à—É–∫ –ø–æ –ø—Ä–æ—î–∫—Ç—É (Enter)">
            </div>
        </header>

        <nav id="workspace-nav">
            <button class="tab-btn active" data-tab="chapters-tab">–†–æ–∑–¥—ñ–ª–∏</button>
            <button class="tab-btn" data-tab="characters-tab">–ü–µ—Ä—Å–æ–Ω–∞–∂—ñ</button>
            <button class="tab-btn" data-tab="locations-tab">–õ–æ–∫–∞—Ü—ñ—ó</button>
            <button class="tab-btn" data-tab="plotlines-tab">–°—é–∂–µ—Ç</button>
            <button class="tab-btn" data-tab="world-tab">–°–≤—ñ—Ç</button>
            <button class="tab-btn" data-tab="chat-tab">–ß–∞—Ç (–û–ø—É—Å)</button>
        </nav>

        <div id="workspace-tabs">
            
            <div id="chapters-tab" class="tab-content active list-editor-layout">
                <aside class="list-pane">
                    <div class="list-header">
                        <h3>–†–æ–∑–¥—ñ–ª–∏</h3>
                        <button id="add-chapter-btn" class="btn-primary">+</button>
                    </div>
                    <div class="chapter-stats-summary">
                        <p id="total-word-count">–ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ª—ñ–≤: 0</p>
                        <p id="word-goal-display">(–ú–µ—Ç–∞: 50000 —Å–ª—ñ–≤)</p>
                        <div class="word-goal-progress-bar">
                            <div id="word-goal-progress" style="width: 0%;"></div>
                        </div>
                    </div>
                    <div id="chapters-list"></div>
                </aside>
                <main id="chapter-editor-pane" class="editor-pane hidden">
                    <div class="editor-pane-header">
                        <input type="text" id="chapter-title" placeholder="–ù–∞–∑–≤–∞ —Ä–æ–∑–¥—ñ–ª—É">
                        <select id="chapter-status">
                            <option value="draft">–ß–µ—Ä–Ω–µ—Ç–∫–∞</option>
                            <option value="first-draft">–ü–µ—Ä—à–∞ –≤–µ—Ä—Å—ñ—è</option>
                            <option value="edited">–†–µ–¥–∞–≥–æ–≤–∞–Ω–æ</option>
                            <option value="final">–§—ñ–Ω–∞–ª</option>
                        </select>
                        <button id="chapter-delete-btn" class="btn-danger">–í–∏–¥–∞–ª–∏—Ç–∏</button>
                    </div>
                    <label for="chapter-synopsis">–°–∏–Ω–æ–ø—Å–∏—Å (–∫–æ—Ä–æ—Ç–∫–∏–π –æ–ø–∏—Å):</label>
                    <textarea id="chapter-synopsis"></textarea>
                    <label for="chapter-text">–¢–µ–∫—Å—Ç —Ä–æ–∑–¥—ñ–ª—É:</label>
                    <textarea id="chapter-text"></textarea>
                    <p id="chapter-stats">–°–ª—ñ–≤ —É —Ä–æ–∑–¥—ñ–ª—ñ: 0</p>
                </main>
                <div id="chapter-editor-placeholder" class="editor-pane-placeholder">
                    <p>–û–±–µ—Ä—ñ—Ç—å —Ä–æ–∑–¥—ñ–ª –∑—ñ —Å–ø–∏—Å–∫—É –∞–±–æ —Å—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π.</p>
                </div>
            </div>

            <div id="characters-tab" class="tab-content list-editor-layout">
                <aside class="list-pane">
                    <div class="list-header">
                        <h3>–ü–µ—Ä—Å–æ–Ω–∞–∂—ñ</h3>
                        <button id="add-character-btn" class="btn-primary">+</button>
                    </div>
                    <div id="characters-list"></div>
                </aside>
                <main id="character-editor-pane" class="editor-pane hidden">
                    <div class="editor-pane-header">
                        <input type="text" id="character-name" placeholder="–Ü–º'—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞">
                        <button id="character-delete-btn" class="btn-danger">–í–∏–¥–∞–ª–∏—Ç–∏</button>
                    </div>
                    <label for="character-description">–û–ø–∏—Å / –ë—ñ–æ–≥—Ä–∞—Ñ—ñ—è:</label>
                    <textarea id="character-description"></textarea>
                    <label for="character-arc">–ê—Ä–∫–∞ / –ú–æ—Ç–∏–≤–∞—Ü—ñ—è:</label>
                    <textarea id="character-arc"></textarea>
                </main>
                <div id="character-editor-placeholder" class="editor-pane-placeholder">
                    <p>–û–±–µ—Ä—ñ—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –∑—ñ —Å–ø–∏—Å–∫—É –∞–±–æ —Å—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–æ–≥–æ.</p>
                </div>
            </div>
            
            <div id="locations-tab" class="tab-content list-editor-layout">
                <aside class="list-pane">
                    <div class="list-header">
                        <h3>–õ–æ–∫–∞—Ü—ñ—ó</h3>
                        <button id="add-location-btn" class="btn-primary">+</button>
                    </div>
                    <div id="locations-list"></div>
                </aside>
                <main id="location-editor-pane" class="editor-pane hidden">
                    <div class="editor-pane-header">
                        <input type="text" id="location-name" placeholder="–ù–∞–∑–≤–∞ –ª–æ–∫–∞—Ü—ñ—ó">
                        <button id="location-delete-btn" class="btn-danger">–í–∏–¥–∞–ª–∏—Ç–∏</button>
                    </div>
                    <label for="location-description">–û–ø–∏—Å –ª–æ–∫–∞—Ü—ñ—ó:</label>
                    <textarea id="location-description"></textarea>
                </main>
                <div id="location-editor-placeholder" class="editor-pane-placeholder">
                    <p>–û–±–µ—Ä—ñ—Ç—å –ª–æ–∫–∞—Ü—ñ—é –∑—ñ —Å–ø–∏—Å–∫—É –∞–±–æ —Å—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤—É.</p>
                </div>
            </div>

            <div id="plotlines-tab" class="tab-content list-editor-layout">
                <aside class="list-pane">
                    <div class="list-header">
                        <h3>–°—é–∂–µ—Ç–Ω—ñ –ª—ñ–Ω—ñ—ó</h3>
                        <button id="add-plotline-btn" class="btn-primary">+</button>
                    </div>
                    <div id="plotlines-list"></div>
                </aside>
                <main id="plotline-editor-pane" class="editor-pane hidden">
                    <div class="editor-pane-header">
                        <input type="text" id="plotline-title" placeholder="–ù–∞–∑–≤–∞ —Å—é–∂–µ—Ç–Ω–æ—ó –ª—ñ–Ω—ñ—ó">
                        <button id="plotline-delete-btn" class="btn-danger">–í–∏–¥–∞–ª–∏—Ç–∏</button>
                    </div>
                    <label for="plotline-description">–û–ø–∏—Å / –ö–ª—é—á–æ–≤—ñ –ø–æ–¥—ñ—ó:</label>
                    <textarea id="plotline-description"></textarea>
                </main>
                <div id="plotline-editor-placeholder" class="editor-pane-placeholder">
                    <p>–û–±–µ—Ä—ñ—Ç—å —Å—é–∂–µ—Ç–Ω—É –ª—ñ–Ω—ñ—é –∞–±–æ —Å—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤—É.</p>
                </div>
            </div>

            <div id="world-tab" class="tab-content">
                <div class="world-grid">
                    <div class="world-grid-item">
                        <label for="premise-textarea">Premise / Logline (–û—Å–Ω–æ–≤–Ω–∞ —ñ–¥–µ—è):</label>
                        <textarea id="premise-textarea"></textarea>
                    </div>
                    <div class="world-grid-item">
                        <label for="theme-textarea">–¢–µ–º–∞:</label>
                        <textarea id="theme-textarea"></textarea>
                    </div>
                    <div class="world-grid-item">
                        <label for="main-arc-textarea">–ì–æ–ª–æ–≤–Ω–∞ –∞—Ä–∫–∞ (A-Story):</label>
                        <textarea id="main-arc-textarea"></textarea>
                    </div>
                    <div class="world-grid-item">
                        <label for="word-goal-input">–ú–µ—Ç–∞ (–∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ª—ñ–≤):</label>
                        <input type="number" id="word-goal-input" value="50000">
                    </div>
                    <div class="world-grid-item">
                        <label for="notes-textarea">–ó–∞–≥–∞–ª—å–Ω—ñ –Ω–æ—Ç–∞—Ç–∫–∏:</label>
                        <textarea id="notes-textarea"></textarea>
                    </div>
                    <div class="world-grid-item">
                        <label for="research-textarea">–î–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è / –†–µ—Ñ–µ—Ä–µ–Ω—Å–∏:</label>
                        <textarea id="research-textarea"></textarea>
                    </div>
                </div>
            </div>

            <div id="chat-tab" class="tab-content">
                <h3>üí¨ –ß–∞—Ç –∑ –û–ø—É—Å–æ–º</h3>
                
                <p>–û–ø—É—Å –º–∞—î –¥–æ—Å—Ç—É–ø –¥–æ –≤—Å—å–æ–≥–æ, —â–æ –≤–∏ –ø–∏—à–µ—Ç–µ –≤ —ñ–Ω—à–∏—Ö –≤–∫–ª–∞–¥–∫–∞—Ö. –ö–µ—Ä—É–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –Ω–∏–∂—á–µ:</p>
                <div id="chat-context-options">
                    <label>
                        <input type="checkbox" id="chat-include-world" checked> –Ø–¥—Ä–æ (–Ü–¥–µ—è, –°–≤—ñ—Ç)
                    </label>
                    <label>
                        <input type="checkbox" id="chat-include-chapters" checked> –†–æ–∑–¥—ñ–ª–∏
                    </label>
                    <label>
                        <input type="checkbox" id="chat-include-characters" checked> –ü–µ—Ä—Å–æ–Ω–∞–∂—ñ
                    </label>
                    <label>
                        <input type="checkbox" id="chat-include-locations" checked> –õ–æ–∫–∞—Ü—ñ—ó
                    </label>
                    <label>
                        <input type="checkbox" id="chat-include-plotlines" checked> –°—é–∂–µ—Ç
                    </label>
                </div>
                
                <div id="chat-window"> </div>
                <div class="chat-input-area">
                    <input type="text" id="userInput" placeholder="–ù–∞–ø–∏—à—ñ—Ç—å —â–æ—Å—å...">
                    <button id="sendButton">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏</button>
                </div>
            </div>

        </div> 
    </div> 
    
    <footer id="app-footer">
        <p>
            Gemini OpusAI | v<span id="version-number">0.0.0</span> | &copy; 2025 Mykhailo Voronianskyi
        </p>
    </footer>

    <div id="project-context-menu" class="context-menu hidden">
        <button id="context-edit-btn">–ó–º—ñ–Ω–∏—Ç–∏ –Ω–∞–∑–≤—É</button>
        <button id="context-export-btn">–ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ (.txt)</button>
        <button id="context-delete-btn">–í–∏–¥–∞–ª–∏—Ç–∏ –ø—Ä–æ—î–∫—Ç</button>
    </div>

    <div id="search-results-modal" class="modal hidden">
        <div class="modal-content">
            <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ—à—É–∫—É</h3>
            <div id="search-results-list">
                </div>
            <div class="modal-buttons">
                <button id="search-results-close-btn" class="btn-secondary">–ó–∞–∫—Ä–∏—Ç–∏</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>

    <script>
      // Your web app's Firebase configuration
      const firebaseConfig = {
        // !!! –í–ê–ñ–õ–ò–í–û: –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —Ç—É—Ç –≤–∞—à—ñ –∞–∫—Ç—É–∞–ª—å–Ω—ñ –∫–ª—é—á—ñ !!!
        apiKey: "AIzaSyBl9t1oqvNvID4dHBsj9PWJqULuMWvc3vg", 
        authDomain: "gemini-opusai.firebaseapp.com",
        projectId: "gemini-opusai",
        storageBucket: "gemini-opusai.appspot.com",
        messagingSenderId: "569032470725",
        appId: "1:569032470725:web:e3a2469d7a22e69818e3c1"
      };
      // v2.5.0: –†–æ–±–∏–º–æ config –≥–ª–æ–±–∞–ª—å–Ω–∏–º, –æ—Å–∫—ñ–ª—å–∫–∏ –≤ main.js (–∫–æ–ª–∏—à–Ω—ñ–π client.js) –ø–æ–∫–∏ —â–æ –Ω–µ–º–∞—î —ñ–º–ø–æ—Ä—Ç—É
      window.firebaseConfig = firebaseConfig; 
    </script>
    
    <script type="module" src="/main.js"></script> 
</body>
</html>